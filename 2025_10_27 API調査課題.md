#NASAAPIについの基本情報 
*用途*
宇宙についての情報が格納されているデータフォーマット
無料で宇宙に関する情報を取得するAPI
衛星や宇宙を周回する天体、惑星や恒星などの座標を、画像や数値として受け取る。

*目的*
宇宙にある研究物のデータを取得する。

*活用例*
宇宙のいい感じの画像を入手できる。
地球と衛星間の距離がわかる。
（三角測量とかできそうだからGPSとかいけそう小並感）

*具体例*
いっぱいあるので面白そうだと思ったのだけ。

#TLEAPI

![[スクリーンショット 2025-10-27 10.23.07.png]]
行軌道要素形式(Two-Line Elements: TLE)
**2行軌道要素形式**（にぎょうきどうようそけいしき、[英](https://ja.wikipedia.org/wiki/%E8%8B%B1%E8%AA%9E "英語"): Two-line elements ： **TLE**）は、[アメリカ航空宇宙局](https://ja.wikipedia.org/wiki/%E3%82%A2%E3%83%A1%E3%83%AA%E3%82%AB%E8%88%AA%E7%A9%BA%E5%AE%87%E5%AE%99%E5%B1%80 "アメリカ航空宇宙局") (NASA) と[北アメリカ航空宇宙防衛司令部](https://ja.wikipedia.org/wiki/%E5%8C%97%E3%82%A2%E3%83%A1%E3%83%AA%E3%82%AB%E8%88%AA%E7%A9%BA%E5%AE%87%E5%AE%99%E9%98%B2%E8%A1%9B%E5%8F%B8%E4%BB%A4%E9%83%A8 "北アメリカ航空宇宙防衛司令部") (NORAD) が現在でも使用している、[人工衛星](https://ja.wikipedia.org/wiki/%E4%BA%BA%E5%B7%A5%E8%A1%9B%E6%98%9F "人工衛星")の[地心座標系](https://ja.wikipedia.org/wiki/%E6%B8%AC%E5%9C%B0%E7%B3%BB "測地系")における[ケプラー軌道要素](https://ja.wikipedia.org/wiki/%E4%BA%BA%E5%B7%A5%E8%A1%9B%E6%98%9F%E3%81%AE%E8%BB%8C%E9%81%93%E8%A6%81%E7%B4%A0#%E3%82%B1%E3%83%97%E3%83%A9%E3%83%BC%E8%BB%8C%E9%81%93%E8%A6%81%E7%B4%A0 "人工衛星の軌道要素")の[テキスト形式](https://ja.wikipedia.org/wiki/%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB "テキストファイル")のフォーマットである(by wiki)

衛星がどこにあるか座標がわかるAPIらしい。

#APIの使い方

*利用登録手順*
1,公式サイト(https://api.nasa.gov/)から以下を入力する
![[スクリーンショット 2025-10-27 9.58.19.png]]
そうしたらメールでAPIキーが送られてくる

*API呼び出し手順*
#HTTPVersion
'''
	
	GET http://tle.ivanstanojevic.me/api/tle?search={q}
'''
以下を追加する

衛星名による検索
'''
	
	GET /api/tle?search={q}
'''
クエリが衛星番号である単一のTLEレコードを取得する
'''
	
	GET /api/tle/{q}
'''
**結果
![[スクリーンショット 2025-10-27 11.13.47.png]]
なんか思った通りにいかない。
色々やった結果、直接はうまくいかなかった。（まとめへ）

#pythonVersion

pythonで衛星軌道を描画してみる
![[スクリーンショット 2025-10-27 11.15.17.png]]
先駆者がいらっしゃった。(https://sorabatake.jp/23655/)

'''

	pip install sgp4
'''

**サンプルコード
'''

	from sgp4.api import Satrec, jday

	# ISSのTLE
	s = '1 25544U 98067A   21226.49389238  .00001429  00000-0  34174-4 0  9998'
	t = '2 25544  51.6437  54.3833 0001250 307.1355 142.9078 15.48901431297630'

	# SGP4による位置・速度の計算
	satellite = Satrec.twoline2rv(s, t)
	jd, fr = jday(2021, 8, 15, 0, 0, 0)
	e, r, v = satellite.sgp4(jd, fr)

	# 結果の出力
	print(r)  # True Equator Mean Equinox position (km)
	print(v)  # True Equator Mean Equinox velocity (km/s)

''''''
![[スクリーンショット 2025-10-27 11.03.53.png]]
こんな感じ
でもこれAPI使ってない希ガス

'''

	# SGP4による位置・速度の計算
	satellite = Satrec.twoline2rv(s, t)
	jd, fr = jday(2021, 8, 15, 0, 0, 0)
	e, r, v = satellite.sgp4(jd, fr)
'''
ここで直打ちしてない？？？？
わからないのでチャッピーに聞いてみた。

'''

	### 処理の流れ

1. Pythonの`requests`ライブラリ（HTTP通信を行うための標準的なライブラリ）を使って、指定されたAPIエンドポイント（`http://tle.ivanstanojevic.me/api/tle/25544`）に**HTTP GETリクエスト**を送信します。
    
2. APIサーバーは、ISS (25544) の最新のTLEデータを**JSON形式**で返却します。
    
3. 受け取ったJSONデータをPythonの辞書（dictionary）オブジェクトに変換します。
    
4. その辞書から、`'line1'` (TLEの1行目) と `'line2'` (TLEの2行目) の値（文字列）を取り出します。
    
5. 取り出した文字列を、元のコードの `s` と `t` の変数に代入します。
    
6. `Satrec.twoline2rv(s, t)` を実行します。
'''

**チャッピー（ジェミニ）が出したコード

’’’
	import requests  # HTTPリクエストのためのライブラリ
from sgp4.api import Satrec, jday
import datetime  # 現在時刻を取得するために使用

	# --- HTTPリクエスト部分 ---

	# 1. ISS (NORAD ID: 25544) のTLEを取得するAPIエンドポイント
	satellite_number = 25544
	url = f"http://tle.ivanstanojevic.me/api/tle/{satellite_number}"
	
	try:
	    # 2. APIにGETリクエストを送信
	    response = requests.get(url)
	    response.raise_for_status()  # エラーが発生したら例外を投げる
	
	    # 3. レスポンスをJSONとしてパース
	    data = response.json()
	
	    # 4. JSONから1行目(line1)と2行目(line2)の文字列を取得
	    s = data['line1']
	    t = data['line2']
	
	    print(f"--- APIから取得したTLE ---")
	    print(f"Satellite: {data.get('name', 'N/A')}")
	    print(f"Line 1: {s}")
	    print(f"Line 2: {t}")
	    print("--------------------------\n")
	
	    # --- ここから下は元のコードとほぼ同じ ---
	
	    # 5. SGP4による位置・速度の計算
	    satellite = Satrec.twoline2rv(s, t)
	
	    # APIから取得したTLEは「最新」のものです。
	    # そのため、計算する時刻も「現在時刻」にするのが合理的です。
	    # (元のコードの2021年の日時は、古いTLE用です)
	    now_utc = datetime.datetime.utcnow()
	    jd, fr = jday(now_utc.year, now_utc.month, now_utc.day, 
	                  now_utc.hour, now_utc.minute, now_utc.second)
	
	    # 6. 計算実行
	    e, r, v = satellite.sgp4(jd, fr)
	
	    # 7. 結果の出力
	    print(f"計算時刻 (UTC): {now_utc}")
	    print(f"位置 (r): {r} (km)")
	    print(f"速度 (v): {v} (km/s)")
	
	except requests.exceptions.RequestException as e:
	    print(f"HTTPリクエスト中にエラーが発生しました: {e}")
	except KeyError:
	    print("APIレスポンスの形式が正しくありません。'line1' または 'line2' が見つかりませんでした。")
	except Exception as e:
	    print(f"予期せぬエラーが発生しました: {e}")
’’’

これでできるらしい。
でも、

’’’
	ご提示いただいた `tle.ivanstanojevic.me` のAPIは、APIキー（認証キー）を必要としない**完全に公開されたAPI (Open API)** です。
’’’
らしい。発行した意味とは。
まあいいや。

**Googleコラボで以下のエラーが発生。

’’’
	HTTPリクエスト中にエラーが発生しました: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
’’’


自分で仮想環境作って実行してもだめだったため計画変更。
**生成コード

’’’
		import requests
	from sgp4.api import Satrec, jday
	import datetime
	
	# --- HTTPリクエスト部分 (CelesTrakのAPIを使用) ---
	
	# 1. ISS (NORAD ID: 25544) のTLEを取得するCelesTrakの公式APIエンドポイント
	satellite_number = 25544
	# FORMAT=TLE を指定すると、3行のテキスト(名前, TLE1, TLE2)で返されます
	url = f"https://celestrak.org/NORAD/elements/gp.php?CATNR={satellite_number}&FORMAT=TLE"
	
	try:
	    # 2. APIにGETリクエストを送信
	    response = requests.get(url)
	    response.raise_for_status()  # エラーが発生したら例外を投げる
	
	    # 3. レスポンスはテキスト形式 (JSONではない)
	    tle_text = response.text
	    
	    # 4. テキストを改行で分割し、必要な行を抽出
	    lines = tle_text.strip().split('\r\n') # Windows形式の改行(\r\n)で分割
	    
	    if len(lines) < 3:
	        # 稀に \n だけで返ってくる場合も考慮
	        lines = tle_text.strip().split('\n')
	        if len(lines) < 3:
	            raise ValueError("APIから期待した3行のTLEデータを取得できませんでした。")
	
	    # CelesTrakは3行で返す (1行目:名前, 2行目:TLE Line1, 3行目:TLE Line2)
	    name = lines[0].strip()
	    s = lines[1].strip()  # TLEの1行目
	    t = lines[2].strip()  # TLEの2行目
	
	    print(f"--- CelesTrak APIから取得したTLE ---")
	    print(f"Satellite: {name}")
	    print(f"Line 1: {s}")
	    print(f"Line 2: {t}")
	    print("----------------------------------\n")
	
	    # --- ここから下は元のコードと同じ ---
	
	    # 5. SGP4による位置・速度の計算
	    # Satrec.twoline2rv は、2行のTLE文字列を渡せば自動で処理します
	    satellite = Satrec.twoline2rv(s, t)
	
	    # 6. 現在時刻で計算
	    now_utc = datetime.datetime.utcnow()
	    jd, fr = jday(now_utc.year, now_utc.month, now_utc.day, 
	                  now_utc.hour, now_utc.minute, now_utc.second)
	
	    # 7. 計算実行
	    e, r, v = satellite.sgp4(jd, fr)
	
	    # 8. 結果の出力
	    print(f"計算時刻 (UTC): {now_utc}")
	    print(f"位置 (r): {r} (km)")
	    print(f"速度 (v): {v} (km/s)")
	
	except requests.exceptions.RequestException as e:
	    print(f"HTTPリクエスト中にエラーが発生しました: {e}")
	except ValueError as e:
	    print(f"データ処理エラー: {e}")
	except Exception as e:
	    print(f"予期せぬエラーが発生しました: {e}")
’’’
できた！！！
![[スクリーンショット 2025-10-27 12.00.28.png]]

**結果

’’’
	 CelesTrak APIから取得したTLE ---
	Satellite: ISS (ZARYA)
	Line 1: 1 25544U 98067A   25299.71634698  .00015600  00000+0  28569-3 0  9995
	Line 2: 2 25544  51.6344  15.2829 0004606 341.7148  18.3675 15.49497961535565
	----------------------------------
	
	計算時刻 (UTC): 2025-10-27 02:56:42.391314
	位置 (r): (-3007.513906661453, 3401.4897761280195, 5050.644932429569) (km)
	速度 (v): (-6.732523302386951, -3.1273878212416153, -1.8943135123268309) (km/s)
’’’’

3000km,速度6km/sぐらい？

#まとめ
宇宙について色々情報を得れるAPI
TLE APIはNASAから直接はなく、CelesTrakから外部経由がいいらしい。
